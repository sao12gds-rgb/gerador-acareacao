<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gerador de Acareação - Azul Cargo</title>

  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family: Arial, sans-serif; background:#f3f4f6; padding:16px; color:#111827; }
    .container { max-width: 720px; margin: 0 auto; }

    /* Card do formulário (igual ao print da tela) */
    .card {
      background:#fff;
      border-radius:16px;
      padding:18px;
      box-shadow: 0 8px 24px rgba(0,0,0,.08);
      overflow:hidden;
    }

    .header {
      text-align:center;
      padding: 8px 6px 14px 6px;
    }
    .header img {
      width: 240px;
      max-width: 75%;
      height:auto;
      display:block;
      margin: 0 auto 10px auto;
    }
    .header h1 {
      font-size: 28px;
      line-height: 1.15;
      color:#0b5ed7;
      font-weight: 800;
      margin-top: 2px;
    }

    .form {
      display:flex;
      flex-direction:column;
      gap: 14px;
      margin-top: 6px;
    }

    .field label{
      display:block;
      font-weight: 700;
      font-size: 15px;
      margin-bottom: 8px;
      color:#111827;
    }
    .req { color:#ef4444; font-weight: 800; margin-left: 4px; }

    .input, .textarea {
      width:100%;
      padding: 14px 14px;
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      font-size: 16px;
      background:#fff;
      outline:none;
      transition: .15s;
    }
    .textarea { min-height: 130px; resize: vertical; }
    .input:focus, .textarea:focus {
      border-color:#93c5fd;
      box-shadow: 0 0 0 4px rgba(59,130,246,.15);
    }
    .helper {
      margin-top: 8px;
      font-size: 13px;
      color:#6b7280;
      line-height: 1.35;
    }

    /* Upload (caixa azul pontilhada) */
    .uploadBox{
      border: 2px dashed #60a5fa;
      background: #eff6ff;
      border-radius: 14px;
      padding: 14px;
    }
    .uploadTitle{
      font-weight: 800;
      color:#0b5ed7;
      margin-bottom: 10px;
      font-size: 16px;
    }
    #fileInput{ display:none; }
    .btnUpload{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      width: 100%;
      padding: 14px;
      border-radius: 12px;
      border: none;
      cursor:pointer;
      font-weight: 800;
      font-size: 16px;
      background:#0b5ed7;
      color:#fff;
    }
    .btnUpload:active{ transform: scale(.99); }
    .preview { margin-top: 12px; display:none; }
    .preview img{
      max-width: 280px;
      width: 100%;
      border-radius: 10px;
      border: 1px solid #d1d5db;
      display:block;
    }

    /* Botão principal (Gerar) grande */
    .btnPrimary{
      width:100%;
      padding: 16px 14px;
      border:none;
      border-radius: 14px;
      background:#0b5ed7;
      color:#fff;
      font-weight: 900;
      font-size: 18px;
      cursor:pointer;
      margin-top: 6px;
    }
    .btnPrimary:active{ transform: scale(.99); }

    /* Botões secundários */
    .actions{
      display:flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 10px;
    }
    .btn{
      width:100%;
      padding: 14px;
      border:none;
      border-radius: 14px;
      font-weight: 900;
      font-size: 16px;
      cursor:pointer;
    }
    .btnGreen{ background:#16a34a; color:#fff; }
    .btnGray{ background:#6b7280; color:#fff; }
    .btnWA{ background:#22c55e; color:#fff; }

    .hidden{ display:none !important; }

    /* ================= DOCUMENTO (IMPRESSÃO / PDF) ================= */
    .pages-container { display:none; }
    .doc-page {
      width: 210mm;
      min-height: 297mm;
      padding: 12mm;
      background:#fff;
      color:#000;
      font-size: 12px;
      line-height: 1.35;
    }
    .doc-logo {
      text-align:center;
      margin-bottom: 8px;
    }
    .doc-logo img { max-width: 150px; height:auto; }
    .doc-title{
      text-align:center;
      font-weight: 900;
      font-size: 13px;
      padding: 6px 0;
      border-top: 1px solid #000;
      border-bottom: 1px solid #000;
      margin-bottom: 8px;
      letter-spacing: .3px;
    }
    .doc-top{
      text-align:center;
      font-weight: 800;
      margin-bottom: 8px;
    }
    .doc-meta{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 6px 18px;
      font-size: 11px;
      margin-bottom: 10px;
    }
    .doc-meta div { border-bottom: 1px solid #e5e7eb; padding-bottom: 4px; }
    .doc-meta strong{ font-weight: 800; }

    /* Página 1: Etiqueta + Diretrizes */
    .etiqueta-space{
      width: 85mm;
      height: 110mm;
      margin: 10px auto 10px auto;
      border: 2px solid #000;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
      position:relative;
      font-weight: 800;
    }
    .etiqueta-space img{
      max-width:100%;
      max-height:100%;
      display:none;
    }
    .doc-diretrizes{
      border: 1px solid #000;
      padding: 8px;
      font-size: 11px;
      white-space: pre-wrap;
      min-height: 55mm;
    }
    .doc-diretrizes-title{
      font-weight: 900;
      margin-bottom: 6px;
      font-size: 11px;
      text-transform: uppercase;
    }

    /* Página 2: Declaração */
    .box{
      border: 2px solid #000;
      padding: 10px;
    }
    .boxTitle{
      text-align:center;
      font-weight: 900;
      margin-bottom: 8px;
      font-size: 12px;
      text-transform: uppercase;
    }
    .line{
      border-bottom: 1px solid #000;
      height: 16px;
      margin: 6px 0 10px 0;
      width:100%;
    }

    .checkGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
      margin-top: 10px;
      font-size: 11px;
    }
    .checkItem{
      border: 1px solid #000;
      padding: 6px;
      display:flex;
      justify-content: space-between;
      align-items:center;
      min-height: 28px;
    }
    .smallNote{
      font-size: 10px;
      text-align:center;
      margin-top: 6px;
      font-weight: 800;
    }

    .linesBlockTitle{
      margin-top: 10px;
      font-weight: 900;
      font-size: 11px;
      text-transform: uppercase;
    }
    .linesBlock{
      border: 1px solid #000;
      padding: 6px;
      margin-top: 6px;
    }
    .writeLine{
      border-bottom: 1px solid #000;
      height: 16px;
      margin: 6px 0;
    }

    .footer2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-top: 10px;
      font-size: 11px;
    }
    .footerField{
      display:flex;
      gap: 8px;
      align-items:flex-end;
    }
    .footerField b{ min-width: 40px; }
    .footerBlank{ border-bottom: 1px solid #000; flex:1; height: 16px; }

    .sign{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-top: 14px;
      text-align:center;
      font-size: 11px;
    }
    .sign .topLine{ border-top: 1px solid #000; padding-top: 6px; font-weight: 800; }

    .page-break { page-break-before: always; }

    @media print {
      body { background:#fff; padding:0; }
      .card { display:none !important; }
      .pages-container { display:block !important; }

      /* garante 2 páginas */
      .doc-page { page-break-after: always; }
      .doc-page:last-child { page-break-after: auto; }

      /* logo menor no PDF */
      .doc-logo img { max-width: 130px; }
    }
  </style>
</head>

<body>
  <div class="container">

    <!-- FORMULÁRIO (tela) -->
    <div class="card">
      <div class="header">
        <img src="logo-azulcargo.png" alt="Azul Cargo Express" />
        <h1>Gerador de Acareação Azul<br/>Cargo</h1>
      </div>

      <div class="form">
        <div class="field">
          <label>Entregador <span class="req">*</span></label>
          <input class="input" id="entregador" placeholder="Ex: EVERTON FRANCISCO" />
        </div>

        <div class="field">
          <label>CTE/CTR <span class="req">*</span></label>
          <input class="input" id="cte" placeholder="Ex: 29031903" />
        </div>

        <div class="field">
          <label>Motivo da Acareação <span class="req">*</span></label>
          <input class="input" id="motivo" placeholder="Ex: CLIENTE DESCONHECE O RECEBIMENTO" />
        </div>

        <div class="field">
          <label>Data da Entrega <span class="req">*</span></label>
          <input class="input" type="date" id="dataEntrega" />
        </div>

        <div class="field">
          <label>Data da Solicitação <span class="req">*</span></label>
          <input class="input" type="date" id="dataSolicitacao" />
        </div>

        <div class="field">
          <label>Data Limite <span class="req">*</span></label>
          <input class="input" type="date" id="dataLimite" />
        </div>

        <div class="field">
          <label>WhatsApp 1 (somente números)</label>
          <input class="input" id="whats1" placeholder="Ex: 5511999999999" inputmode="numeric" />
        </div>

        <div class="field">
          <label>WhatsApp 2 (somente números)</label>
          <input class="input" id="whats2" placeholder="Ex: 5511988888888" inputmode="numeric" />
        </div>

        <div class="field">
          <label>Diretrizes (Página 1) — opcional</label>
          <textarea class="textarea" id="diretrizes" placeholder="Cole aqui as diretrizes que devem sair na Página 1..."></textarea>
          <div class="helper">Esse texto sai no PDF/Impressão (Página 1).</div>
        </div>

        <div class="uploadBox">
          <div class="uploadTitle">Etiqueta (imagem) <span class="req">*</span> — sai na Página 1 e IMPRIME</div>
          <input type="file" id="fileInput" accept="image/*" />
          <button class="btnUpload" type="button" onclick="document.getElementById('fileInput').click()">
            Selecionar etiqueta
          </button>

          <div class="preview" id="previewBox">
            <div class="helper" style="margin:10px 0 6px 0;">Prévia:</div>
            <img id="previewImg" alt="Etiqueta" />
          </div>
        </div>

        <div class="field">
          <label>Mensagem WhatsApp (gerada automaticamente)</label>
          <textarea class="textarea" id="msg" readonly placeholder="Clique em “Gerar Documento” para preencher automaticamente..."></textarea>
        </div>

        <button class="btnPrimary" type="button" onclick="gerar()">Gerar Documento</button>

        <div class="actions">
          <button class="btn btnGreen hidden" id="btnPDF" type="button" onclick="baixarPDF()">✅ Baixar PDF (Imprimir / Salvar como PDF)</button>
          <button class="btn btnGray hidden" id="btnCopy" type="button" onclick="copiarMensagem()">✅ Copiar Mensagem</button>
          <button class="btn btnWA hidden" id="btnWA1" type="button" onclick="abrirWhatsApp(1)">✅ Abrir WhatsApp 1</button>
          <button class="btn btnWA hidden" id="btnWA2" type="button" onclick="abrirWhatsApp(2)">✅ Abrir WhatsApp 2</button>
        </div>
      </div>
    </div>

    <!-- DOCUMENTO (PDF/Impressão) -->
    <div class="pages-container" id="pages">

      <!-- PÁGINA 1 -->
      <div class="doc-page">
        <div class="doc-logo">
          <img src="logo-azulcargo.png" alt="Azul Cargo Express">
        </div>

        <div class="doc-title">ACAREAÇÃO</div>

        <div class="doc-top">
          ENTREGADOR: <span id="p1-entregador"></span>
        </div>

        <div class="doc-meta">
          <div><strong>Data Entrega:</strong> <span id="p1-dataEntrega"></span></div>
          <div><strong>Data Solicitação:</strong> <span id="p1-dataSolicitacao"></span></div>
          <div><strong>Data Limite:</strong> <span id="p1-dataLimite"></span></div>
          <div><strong>Motivo:</strong> <span id="p1-motivo"></span></div>
          <div style="grid-column: 1 / -1;"><strong>CTE:</strong> <span id="p1-cte"></span></div>
        </div>

        <div class="etiqueta-space">
          <img id="etiquetaDocImg" alt="Etiqueta">
          <span id="etiquetaTexto">ETIQUETA</span>
        </div>

        <div class="doc-diretrizes-title">Diretrizes</div>
        <div class="doc-diretrizes" id="p1-diretrizes"></div>
      </div>

      <!-- PÁGINA 2 -->
      <div class="doc-page page-break">
        <div class="doc-logo">
          <img src="logo-azulcargo.png" alt="Azul Cargo Express">
        </div>

        <div class="doc-title">ACAREAÇÃO</div>

        <div class="doc-top">
          ENTREGADOR: <span id="p2-entregador"></span>
        </div>

        <div class="doc-meta">
          <div><strong>Data Entrega:</strong> <span id="p2-dataEntrega"></span></div>
          <div><strong>Data Solicitação:</strong> <span id="p2-dataSolicitacao"></span></div>
          <div><strong>Data Limite:</strong> <span id="p2-dataLimite"></span></div>
          <div><strong>Motivo:</strong> <span id="p2-motivo"></span></div>
          <div style="grid-column: 1 / -1;"><strong>CTE:</strong> <span id="p2-cte"></span></div>
        </div>

        <div class="box">
          <div class="boxTitle">ACAREAÇÃO</div>

          <div><b>Eu,</b></div>
          <div class="line"></div>

          <div><b>portador(a) do documento RG/CPF nº</b></div>
          <div class="line"></div>

          <div><b>grau de parentesco com destinatário</b></div>
          <div class="line"></div>

          <div>
            declaro informações referente ao CTE
            <b><span id="p2-cte-decl"></span></b>
            (Campos de preenchimento obrigatório):
          </div>

          <div class="checkGrid">
            <div class="checkItem"><span>Recebi a carga mencionada</span><b>SIM ☐  NÃO ☐</b></div>
            <div class="checkItem"><span>Produtos internos intactos</span><b>SIM ☐  NÃO ☐</b></div>
            <div class="checkItem"><span>Carga em perfeitas condições</span><b>SIM ☐  NÃO ☐</b></div>
            <div class="checkItem"><span>Embalagem ok</span><b>SIM ☐  NÃO ☐</b></div>
            <div class="checkItem" style="grid-column: 1 / -1;"><span>Faltando itens do pedido</span><b>SIM ☐  NÃO ☐</b></div>
          </div>

          <div class="smallNote">Preenchimento obrigatório: SIM ou NÃO</div>
        </div>

        <div class="linesBlockTitle">Relato destinatário (OBRIGATÓRIO):</div>
        <div class="linesBlock">
          <div class="writeLine"></div>
          <div class="writeLine"></div>
          <div class="writeLine"></div>
          <div class="writeLine"></div>
        </div>

        <div class="linesBlockTitle">Observações Entregador (OBRIGATÓRIO):</div>
        <div class="linesBlock">
          <div class="writeLine"></div>
          <div class="writeLine"></div>
          <div class="writeLine"></div>
          <div class="writeLine"></div>
        </div>

        <div class="footer2">
          <div class="footerField"><b>Local:</b><div class="footerBlank"></div></div>
          <div class="footerField"><b>Data:</b><div class="footerBlank"></div></div>
        </div>

        <div class="sign">
          <div class="topLine">Nome/Assinatura do cliente</div>
          <div class="topLine">Nome/Assinatura do entregador<br><span id="p2-assinatura"></span></div>
        </div>
      </div>

    </div>
  </div>

  <script>
    function onlyDigits(s){ return (s || "").toString().replace(/\D/g,''); }

    function formatarDataBR(iso){
      if(!iso) return "";
      const [y,m,d] = iso.split("-");
      return ${d}/${m}/${y};
    }

    function montarMensagem(d){
      return (
`Olá! Tudo bem?

Segue em anexo o documento de ACAREAÇÃO.

* CTE: ${d.cte}
* Motivo: ${d.motivo}
* Entregador: ${d.entregador}
* Data Entrega: ${d.dataEntrega}
* Data Solicitação: ${d.dataSolicitacao}
* Data Limite: ${d.dataLimite}

Por gentileza, confirmar o recebimento e nos retornar após o preenchimento.`
      );
    }

    // Upload etiqueta
    document.getElementById('fileInput').addEventListener('change', function(e){
      const file = e.target.files && e.target.files[0];
      if(!file) return;

      const reader = new FileReader();
      reader.onload = function(ev){
        const src = ev.target.result;

        // preview
        document.getElementById('previewImg').src = src;
        document.getElementById('previewBox').style.display = 'block';

        // documento (imprime)
        const img = document.getElementById('etiquetaDocImg');
        img.src = src;
        img.style.display = 'block';
        document.getElementById('etiquetaTexto').style.display = 'none';
      };
      reader.readAsDataURL(file);
    });

    function gerar(){
      const entregador = (document.getElementById('entregador').value || "").trim().toUpperCase();
      const cte = (document.getElementById('cte').value || "").trim();
      const motivo = (document.getElementById('motivo').value || "").trim();

      const dataEntrega = document.getElementById('dataEntrega').value;
      const dataSolicitacao = document.getElementById('dataSolicitacao').value;
      const dataLimite = document.getElementById('dataLimite').value;

      if(!entregador || !cte || !motivo || !dataEntrega || !dataSolicitacao || !dataLimite){
        alert("Preencha todos os campos obrigatórios (*)");
        return;
      }

      // Diretrizes (opcional)
      const diretrizes = (document.getElementById('diretrizes').value || "").trim();

      // Preenche PÁG 1
      document.getElementById('p1-entregador').textContent = entregador;
      document.getElementById('p1-dataEntrega').textContent = formatarDataBR(dataEntrega);
      document.getElementById('p1-dataSolicitacao').textContent = formatarDataBR(dataSolicitacao);
      document.getElementById('p1-dataLimite').textContent = formatarDataBR(dataLimite);
      document.getElementById('p1-motivo').textContent = motivo;
      document.getElementById('p1-cte').textContent = cte;
      document.getElementById('p1-diretrizes').textContent = diretrizes || "";

      // Preenche PÁG 2
      document.getElementById('p2-entregador').textContent = entregador;
      document.getElementById('p2-dataEntrega').textContent = formatarDataBR(dataEntrega);
      document.getElementById('p2-dataSolicitacao').textContent = formatarDataBR(dataSolicitacao);
      document.getElementById('p2-dataLimite').textContent = formatarDataBR(dataLimite);
      document.getElementById('p2-motivo').textContent = motivo;
      document.getElementById('p2-cte').textContent = cte;
      document.getElementById('p2-cte-decl').textContent = cte;
      document.getElementById('p2-assinatura').textContent = entregador;

      // Mensagem WhatsApp
      const msg = montarMensagem({
        cte,
        motivo,
        entregador,
        dataEntrega: formatarDataBR(dataEntrega),
        dataSolicitacao: formatarDataBR(dataSolicitacao),
        dataLimite: formatarDataBR(dataLimite),
      });
      document.getElementById('msg').value = msg;

      // Mostra botões
      document.getElementById('btnPDF').classList.remove('hidden');
      document.getElementById('btnCopy').classList.remove('hidden');
      document.getElementById('btnWA1').classList.remove('hidden');
      document.getElementById('btnWA2').classList.remove('hidden');

      // Garante que as páginas existem (para PDF)
      document.getElementById('pages').style.display = 'block';
    }

    function baixarPDF(){
      // abre impressão -> usuário salva como PDF (2 páginas)
      document.getElementById('pages').style.display = 'block';
      window.print();
    }

    function copiarMensagem(){
      const txt = document.getElementById('msg').value || "";
      if(!txt.trim()){ alert("Gere o documento primeiro."); return; }

      navigator.clipboard.writeText(txt).then(() => {
        alert("Mensagem copiada!");
      }).catch(() => {
        alert("Não consegui copiar automaticamente. Selecione e copie manualmente.");
      });
    }

    function abrirWhatsApp(which){
      const msg = document.getElementById('msg').value || "";
      if(!msg.trim()){ alert("Gere o documento primeiro."); return; }

      const n1 = onlyDigits(document.getElementById('whats1').value);
      const n2 = onlyDigits(document.getElementById('whats2').value);
      const numero = (which === 1 ? n1 : n2);

      const texto = encodeURIComponent(msg);

      // Se tiver número: abre conversa já com a mensagem
      // Se não tiver número: abre WhatsApp Web
      const url = numero ? https://wa.me/${numero}?text=${texto} : https://web.whatsapp.com/;
      window.open(url, "_blank");
    }
  </script>
</body>
</html>
